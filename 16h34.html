<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Trang Ph·ª•c - Nh·ªõ V≈© (Final)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- C·∫§U H√åNH CHUNG --- */
        body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: #ebedf0; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; padding-bottom: 60px; }
        
        /* Header */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: white; padding: 15px 25px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        h1 { color: #ee4d2d; margin: 0; font-size: 24px; font-weight: 700; text-transform: uppercase; }
        .cart-icon { position: relative; font-size: 26px; color: #ee4d2d; cursor: pointer; }
        .cart-count { position: absolute; top: -8px; right: -10px; background: #ee4d2d; color: white; font-size: 12px; padding: 3px 7px; border-radius: 10px; border: 2px solid white; font-weight: bold;}

        /* L∆∞·ªõi s·∫£n ph·∫©m */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 20px;
        }

        /* --- TH·∫∫ S·∫¢N PH·∫®M --- */
        .product-card {
            background: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 5px 0 rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            transition: transform 0.2s;
            position: relative;
            border: 1px solid #e5e5e5;
        }
        .product-card:hover { border-color: #ee4d2d; transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }

        /* ·∫¢nh & Badge */
        .image-box {
            position: relative;
            width: 100%;
            padding-top: 100%; /* Khung vu√¥ng */
            background: #fafafa;
            border-bottom: 1px solid #f1f1f1;
        }
        .image-box img {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain;
        }
        
        /* Badge hi·ªÉn th·ªã L√£i/L·ªó */
        .badge-box {
            position: absolute; top: 0; right: 0;
            padding: 6px 12px; color: #fff;
            border-bottom-left-radius: 8px;
            display: flex; flex-direction: column; align-items: flex-end;
            box-shadow: -2px 2px 6px rgba(0,0,0,0.15);
            z-index: 5;
        }
        .badge-profit { background: linear-gradient(135deg, #00b09b, #96c93d); } /* Xanh l√° */
        .badge-loss { background: linear-gradient(135deg, #ff416c, #ff4b2b); }   /* ƒê·ªè cam */
        
        .badge-title { font-size: 10px; text-transform: uppercase; font-weight: 800; opacity: 0.9; margin-bottom: 2px; }
        .badge-money { font-size: 16px; font-weight: 800; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .badge-percent { font-size: 11px; background: rgba(0,0,0,0.2); padding: 2px 6px; border-radius: 4px; margin-top: 3px; font-weight: 600;}

        /* Overlay H·∫øt h√†ng */
        .out-of-stock-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.7); z-index: 1; display: none;
        }
        .out-of-stock-label {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(50,50,50,0.95); color: white; border-radius: 50%;
            width: 80px; height: 80px; display: flex; align-items: center; justify-content: center;
            font-size: 14px; text-align: center; font-weight: bold; z-index: 2; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* Th√¥ng tin */
        .info { padding: 15px; display: flex; flex-direction: column; flex-grow: 1; }
        
        .title { font-size: 18px; font-weight: 700; color: #333; margin-bottom: 6px; line-height: 1.3; }
        .desc { font-size: 13px; color: #666; margin-bottom: 12px; height: 38px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; font-style: italic; line-height: 1.4;}
        
        /* Size tags */
        .size-area { display: flex; gap: 6px; margin-bottom: 15px; flex-wrap: wrap; }
        .size-tag { font-size: 11px; border: 1px solid #ddd; padding: 3px 8px; border-radius: 4px; color: #444; background: #fff; font-weight: 600;}

        /* C·∫∑p ƒë√¥i gi√° */
        .price-row {
            display: flex; justify-content: space-between; align-items: flex-end;
            margin-bottom: 15px; background: #fff5f5; border: 1px dashed #ee4d2d; padding: 10px 12px; border-radius: 6px;
        }
        .p-block { display: flex; flex-direction: column; }
        .p-label { font-size: 10px; color: #777; font-weight: 700; text-transform: uppercase; margin-bottom: 3px;}
        
        .price-rent { color: #ee4d2d; font-size: 20px; font-weight: 800; }
        .price-import { color: #2c3e50; font-size: 20px; font-weight: 700; }

        /* --- B·∫¢NG QU·∫¢N L√ù (ƒê√£ th√™m d√≤ng t·ªïng v·ªën) --- */
        .admin-panel {
            background: #f8f9fa;
            border-radius: 6px;
            overflow: hidden;
            font-size: 12px;
            margin-bottom: 15px;
            border: 1px solid #eee;
        }
        
        /* D√≤ng 1: Kho h√†ng */
        .inventory-row {
            display: grid; grid-template-columns: 1fr 1fr 1fr;
            border-bottom: 1px solid #e0e0e0;
            text-align: center;
            background: #fff;
        }
        .inv-item { padding: 10px 2px; }
        .inv-label { font-size: 10px; color: #888; margin-bottom: 4px; display: block; text-transform: uppercase; font-weight: 600;}
        .inv-val { font-weight: 800; font-size: 14px; color: #333; }
        .inv-val.renting { color: #e67e22; }
        
        /* D√≤ng 2: T·ªîNG V·ªêN (M·ªöI TH√äM) */
        .capital-row {
            padding: 8px 15px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px dashed #ccc;
            background: #fdfdfd;
        }
        .cap-label { color: #555; font-weight: 600; }
        .cap-val { color: #2c3e50; font-weight: 800; font-size: 13px;}

        /* D√≤ng 3: T·ªïng thu */
        .finance-row { 
            padding: 8px 15px; 
            display: flex; justify-content: space-between; align-items: center; 
            background: #f1f8e9; /* N·ªÅn xanh nh·∫π */
        }
        .f-label { color: #33691e; }
        .f-val { font-weight: 800; color: #2e7d32; font-size: 13px; }

        /* N√∫t b·∫•m */
        .action-area { display: flex; gap: 10px; margin-top: auto; }
        .btn {
            flex: 1; padding: 12px 0; font-size: 14px; cursor: pointer; border-radius: 4px;
            display: flex; align-items: center; justify-content: center; font-weight: 700; border: none; transition: 0.2s;
        }
        .btn-cart {
            background: #fff0eb; color: #ee4d2d; border: 1px solid #ee4d2d;
        }
        .btn-cart:hover { background: #ffece5; }
        
        .btn-buy {
            background: #ee4d2d; color: white;
            box-shadow: 0 2px 5px rgba(238, 77, 45, 0.4);
        }
        .btn-buy:hover { opacity: 0.9; box-shadow: 0 4px 8px rgba(238, 77, 45, 0.5); }

        .disabled { background: #e0e0e0 !important; color: #999 !important; border: 1px solid #e0e0e0 !important; cursor: not-allowed; box-shadow: none !important;}

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1><i class="fas fa-store"></i> KHO TRANG PH·ª§C NH·ªö V≈®</h1>
        <div class="cart-icon" onclick="alert('Demo: ƒê√£ m·ªü gi·ªè h√†ng')">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-count" id="total-cart">0</span>
        </div>
    </header>

    <div class="product-grid" id="list">
        </div>
</div>

<script>
    // 1. C√ÅC H√ÄM ƒê·ªäNH D·∫†NG S·ªê
    const formatMoney = (n) => n.toLocaleString('vi-VN') + ' ƒë'; // ƒê·ªãnh d·∫°ng ƒë·∫ßy ƒë·ªß: 1.000.000 ƒë
    
    // ƒê·ªãnh d·∫°ng r√∫t g·ªçn cho c√°c √¥ nh·ªè (Badge, Gi√°): 1.5tr, 50k
    const formatCompact = (n) => {
        if (Math.abs(n) >= 1000000) return (n / 1000000).toFixed(1).replace('.0','') + "tr";
        return (n / 1000).toFixed(0) + "k";
    };

    // --- 2. D·ªÆ LI·ªÜU S·∫¢N PH·∫®M ---
    const products = [
        {
            id: "SP01",
            name: "B·ªô ƒê·ªôi M·∫ßm Non",
            desc: "Trang ph·ª•c r·∫±n ri, v·∫£i th√¥ m√°t, k√®m m≈© tai b√®o. Ph√π h·ª£p cho b√© di·ªÖn vƒÉn ngh·ªá ch·ªß ƒë·ªÅ ng∆∞·ªùi l√≠nh.",
            image: "https://scontent.fhan3-4.fna.fbcdn.net/v/t39.30808-6/597815238_3723993384407910_5234550624042161977_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=f727a1&_nc_ohc=nBUQxEDpzAwQ7kNvwF49k_2&_nc_oc=AdkBsb9O3F7RKBhHmpytL9nlENqrTi0GAyF2emtVpaVoUQ1vw66qD8p0YhsjfUMCt6Y&_nc_zt=23&_nc_ht=scontent.fhan3-4.fna&_nc_gid=puY3JUu8l1uelfNiQFC1YQ&oh=00_Afk80ZPk9lWa7FJtxkHpQMXDNsE0bEHTJHU_r2uoFc8r6g&oe=694060C3",
            
            // S·ªë l∆∞·ª£ng t·ª´ng Size (T·ªïng kho t·ª± t√≠nh)
            sizes: { S: 10, M: 20, L: 15, XL: 5 }, 
            
            renting: 12,        // ƒêang cho thu√™
            importPrice: 40000, // Gi√° v·ªën
            rentPrice: 50000,   // Gi√° thu√™
            rentalCount: 60     // L∆∞·ª£t ƒë√£ thu√™
        },
        {
            id: "SP02",
            name: "V√°y C√¥ng Ch√∫a Elsa",
            desc: "V√°y xanh l·∫•p l√°nh cao c·∫•p, t√πng v√°y 3 l·ªõp b·ªìng b·ªÅnh. (L∆∞u √Ω: Size S ƒë√£ h·∫øt)",
            image: "https://scontent.fhan3-2.fna.fbcdn.net/v/t39.30808-6/571752284_3677492955724620_8401090886270008091_n.jpg?_nc_cat=107&ccb=1-7&_nc_sid=f727a1&_nc_ohc=QtoFX3y-wuMQ7kNvwGvrren&_nc_oc=AdkR6EAQmfnyt74O6v2OB9K5BmtRuV5HRmcwnVWqQFuuP9SnypAOwb82wpFE1XFFYlo&_nc_zt=23&_nc_ht=scontent.fhan3-2.fna&_nc_gid=ZsotwW0zmnNcCqkS99x-WQ&oh=00_AfnzkSxcTGRaIp1sLRV-lcMs9EvbwpNC5CnkcwSMyWO07A&oe=69405AC4",
            
            sizes: { S: 0, M: 2, L: 5, XL: 0 }, 
            
            renting: 7, // H·∫æT H√ÄNG (V√¨ T·ªïng kho = 7, ƒêang thu√™ = 7)
            importPrice: 150000,
            rentPrice: 70000,
            rentalCount: 5      
        }
    ];

    const container = document.getElementById('list');
    let cartCount = 0;

    products.forEach(p => {
        // --- T√çNH TO√ÅN ---
        const totalStock = Object.values(p.sizes).reduce((acc, curr) => acc + curr, 0); // T·ªïng size
        const available = totalStock - p.renting; // C√≤n l·∫°i
        
        const totalInvest = totalStock * p.importPrice; // T·ªïng v·ªën
        const totalRev = p.rentalCount * p.rentPrice;   // T·ªïng thu
        const profit = totalRev - totalInvest;          // L·ª£i nhu·∫≠n
        
        const isProfit = profit >= 0;
        
        // Badge logic
        let badgeClass = isProfit ? "badge-profit" : "badge-loss";
        let badgeTitle = isProfit ? "ƒêANG L√ÉI" : "H·ªíI V·ªêN";
        let percent = 0;
        if(isProfit) {
            percent = totalInvest > 0 ? Math.round((profit / totalInvest) * 100) : 100;
        } else {
            percent = totalInvest > 0 ? Math.round((totalRev / totalInvest) * 100) : 0;
        }
        const sign = isProfit ? "+" : ""; 
        
        // Tr·∫°ng th√°i H·∫øt h√†ng
        const isOutOfStock = available <= 0;
        const overlayHtml = isOutOfStock ? `<div class="out-of-stock-overlay" style="display:block"></div><div class="out-of-stock-label">H·∫æT<br>H√ÄNG</div>` : "";
        const btnState = isOutOfStock ? "disabled" : "";
        const btnEvent = isOutOfStock ? "" : `onclick="addToCart('${p.name}')"`;

        // Size HTML
        const sizeHtml = Object.entries(p.sizes).map(([key, val]) => 
            `<span class="size-tag">${key}: ${val}</span>`
        ).join("");

        // RENDER HTML
        const html = `
        <div class="product-card">
            <div class="image-box">
                <img src="${p.image}" onerror="this.src='https://via.placeholder.com/300'">
                <div class="badge-box ${badgeClass}">
                    <span class="badge-title">${badgeTitle}</span>
                    <span class="badge-money">${sign}${formatCompact(profit)}</span>
                    <span class="badge-percent">${percent}%</span>
                </div>
                ${overlayHtml}
            </div>
            
            <div class="info">
                <div class="title">[${p.id}] ${p.name}</div>
                <div class="desc">${p.desc}</div>
                
                <div class="size-area">
                    ${sizeHtml}
                </div>

                <div class="price-row">
                    <div class="p-block">
                        <span class="p-label">Gi√° V·ªën</span>
                        <span class="price-import">${formatCompact(p.importPrice)}</span>
                    </div>
                    <div class="p-block" style="text-align:right">
                        <span class="p-label">Gi√° Thu√™</span>
                        <span class="price-rent">${formatCompact(p.rentPrice)}</span>
                    </div>
                </div>

                <div class="admin-panel">
                    <div class="inventory-row">
                        <div class="inv-item" style="border-right:1px solid #eee">
                            <span class="inv-label">üì¶ T·ªïng kho</span>
                            <span class="inv-val">${totalStock}</span>
                        </div>
                        <div class="inv-item" style="border-right:1px solid #eee">
                            <span class="inv-label">üîÑ ƒêang thu√™</span>
                            <span class="inv-val renting">${p.renting}</span>
                        </div>
                        <div class="inv-item">
                            <span class="inv-label">‚úÖ T·∫°i Shop</span>
                            <span class="inv-val" style="color:${isOutOfStock ? 'red' : 'green'}">${available}</span>
                        </div>
                    </div>

                    <div class="capital-row">
                        <span class="cap-label">üí∏ T·ªïng v·ªën ƒë·∫ßu t∆∞:</span>
                        <span class="cap-val">${formatMoney(totalInvest)}</span>
                    </div>
                    
                    <div class="finance-row">
                        <span class="f-label">ƒê√£ cho thu√™ <b>${p.rentalCount}</b> l∆∞·ª£t</span>
                        <span class="f-val">Thu: ${formatMoney(totalRev)}</span>
                    </div>
                </div>

                <div class="action-area">
                    <button class="btn btn-cart ${btnState}" ${btnEvent}>
                        <i class="fas fa-cart-plus" style="margin-right:8px"></i> Th√™m
                    </button>
                    <button class="btn btn-buy ${btnState}">
                        L√™n ƒë∆°n ngay
                    </button>
                </div>
            </div>
        </div>
        `;
        container.innerHTML += html;
    });

    function addToCart(name) {
        cartCount++;
        document.getElementById('total-cart').innerText = cartCount;
        alert(`ƒê√£ th√™m "${name}" v√†o gi·ªè h√†ng!`);
    }
</script>

</body>
</html>